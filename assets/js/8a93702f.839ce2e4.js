"use strict";(self.webpackChunkweekoflearning_docsite=self.webpackChunkweekoflearning_docsite||[]).push([[445],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(n),m=o,h=p["".concat(l,".").concat(m)]||p[m]||d[m]||a;return n?r.createElement(h,i(i({ref:t},u),{},{components:n})):r.createElement(h,i({ref:t},u))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:o,i[1]=s;for(var c=2;c<a;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8906:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var r=n(7462),o=(n(7294),n(3905));const a={},i="aml-templates",s={unversionedId:"aml-templates/README",id:"aml-templates/README",title:"aml-templates",description:"template repository for azure machine learnings",source:"@site/docs/aml-templates/README.md",sourceDirName:"aml-templates",slug:"/aml-templates/",permalink:"/documentations/aml-templates/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsidebar",previous:{title:"Microsoft Open Source Code of Conduct",permalink:"/documentations/aml-templates/CODE_OF_CONDUCT"},next:{title:"SECURITY",permalink:"/documentations/aml-templates/SECURITY"}},l={},c=[{value:"1. Prerequisites",id:"1-prerequisites",level:3},{value:"2. Create repository",id:"2-create-repository",level:3},{value:"3. Setting up the required secrets",id:"3-setting-up-the-required-secrets",level:3},{value:"4. Define your workspace parameters",id:"4-define-your-workspace-parameters",level:3},{value:"5. Modify the code",id:"5-modify-the-code",level:3},{value:"6. Viewing your AML resources and runs",id:"6-viewing-your-aml-resources-and-runs",level:3},{value:"Code structure",id:"code-structure",level:2},{value:"Documentation of Azure Machine Learning GitHub Actions",id:"documentation-of-azure-machine-learning-github-actions",level:2},{value:"Known issues",id:"known-issues",level:2},{value:"Error: MissingSubscriptionRegistration",id:"error-missingsubscriptionregistration",level:3}],u={toc:c};function p(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"aml-templates"},"aml-templates"),(0,o.kt)("p",null,"template repository for azure machine learnings"),(0,o.kt)("p",{align:"center"},(0,o.kt)("img",{src:"docs/images/aml.svg",height:"80"}),(0,o.kt)("img",{src:"https://i.ya-webdesign.com/images/a-plus-png-2.png",alt:"plus",height:"40"}),(0,o.kt)("img",{src:"docs/images/actions.png",alt:"Azure Machine Learning + Actions",height:"80"})),(0,o.kt)("p",null,"this template is written in accordance with specific versions of aml github actions\nconfirm to below table to check the supported versions. "),(0,o.kt)("h1",{id:"getting-started"},"Getting started"),(0,o.kt)("h3",{id:"1-prerequisites"},"1. Prerequisites"),(0,o.kt)("p",null,"The following prerequisites are required to make this repository work:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Azure subscription"," If you don\u2019t have an Azure subscription, create a free account before you begin. Try the ",(0,o.kt)("a",{parentName:"li",href:"https://aka.ms/AMLFree"},"free or paid version of Azure Machine Learning")," today.")),(0,o.kt)("h3",{id:"2-create-repository"},"2. Create repository"),(0,o.kt)("p",null,'To get started with ML Ops using auzre ml actions, simply create a new repo based off this template, by clicking on the green "Use this template" button:'),(0,o.kt)("p",{align:"center"},(0,o.kt)("img",{src:"https://help.github.com/assets/images/help/repository/use-this-template-button.png",alt:"GitHub Template repository",width:"700"})),(0,o.kt)("h3",{id:"3-setting-up-the-required-secrets"},"3. Setting up the required secrets"),(0,o.kt)("p",null,"A service principal needs to be generated for authentication and getting access to your Azure subscription. We suggest adding a service principal with contributor rights to a new resource group or to the one where you have deployed your existing Azure Machine Learning workspace. Just go to the Azure Portal to find the details of your resource group or workspace. Then start the Cloud CLI or install the ",(0,o.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest"},"Azure CLI")," on your computer and execute the following command to generate the required credentials:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"# Replace {service-principal-name}, {subscription-id} and {resource-group} with your \n# Azure subscription id and resource group name and any name for your service principle\n# if you want to provide a subscription level access to SP then remove the resource group part\naz ad sp create-for-rbac --name {service-principal-name} \\\n                         --role contributor \\\n                         --scopes /subscriptions/{subscription-id}/resourceGroups/{resource-group} \\\n                         --sdk-auth\n")),(0,o.kt)("p",null,"This will generate the following JSON output:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'{\n  "clientId": "<GUID>",\n  "clientSecret": "<GUID>",\n  "subscriptionId": "<GUID>",\n  "tenantId": "<GUID>",\n  (...)\n}\n')),(0,o.kt)("p",null,"Add this JSON output as ",(0,o.kt)("a",{parentName:"p",href:"https://help.github.com/en/actions/configuring-and-managing-workflows/creating-and-storing-encrypted-secrets#creating-encrypted-secrets"},"a secret")," with the name ",(0,o.kt)("inlineCode",{parentName:"p"},"AZURE_CREDENTIALS")," in your GitHub repository:"),(0,o.kt)("p",{align:"center"},(0,o.kt)("img",{src:"docs/images/secrets.png",alt:"GitHub Template repository",width:"700"})),(0,o.kt)("p",null,"To do so, click on the Settings tab in your repository, then click on Secrets and finally add the new secret with the name ",(0,o.kt)("inlineCode",{parentName:"p"},"AZURE_CREDENTIALS")," to your repository."),(0,o.kt)("p",null,"Please follow ",(0,o.kt)("a",{parentName:"p",href:"https://help.github.com/en/actions/configuring-and-managing-workflows/creating-and-storing-encrypted-secrets#creating-encrypted-secrets"},"this link")," for more details. "),(0,o.kt)("h3",{id:"4-define-your-workspace-parameters"},"4. Define your workspace parameters"),(0,o.kt)("p",null,"You have to modify the parameters in the ",(0,o.kt)("a",{href:"/.cloud/.azure/workspace.json"},(0,o.kt)("inlineCode",{parentName:"p"},'/.cloud/.azure/workspace.json"')," file")," in your repository, so that the GitHub Actions create or connect to the desired Azure Machine Learning workspace. Just click on the link and edit the file."),(0,o.kt)("p",null,"Please use the same value for the ",(0,o.kt)("inlineCode",{parentName:"p"},"resource_group")," parameter that you have used when generating the azure credentials. If you already have an Azure ML Workspace under that resource group, change the ",(0,o.kt)("inlineCode",{parentName:"p"},"name")," parameter in the JSON file to the name of your workspace, if you want the Action to create a new workspace in that resource group, pick a name for your new workspace, and assign it to the ",(0,o.kt)("inlineCode",{parentName:"p"},"name")," parameter. You can also delete the ",(0,o.kt)("inlineCode",{parentName:"p"},"name")," parameter, if you want the action to use the default value, which is the repository name."),(0,o.kt)("p",null,"Once you save your changes to the file, the predefined GitHub workflow that trains and deploys a model on Azure Machine Learning gets triggered. Check the actions tab to view if your actions have successfully run."),(0,o.kt)("h3",{id:"5-modify-the-code"},"5. Modify the code"),(0,o.kt)("p",null,"Now you can start modifying the code in the ",(0,o.kt)("a",{href:"/code"},(0,o.kt)("inlineCode",{parentName:"p"},"code")," folder"),", so that your model and not the provided sample model gets trained on Azure. Where required, modify the environment yaml so that the training and deployment environments will have the correct packages installed in the conda environment for your training and deployment.\nUpon pushing the changes, actions will kick off your training and deployment run. Check the actions tab to view if your actions have successfully run."),(0,o.kt)("p",null,"Comment lines 39 to 55 in your ",(0,o.kt)("a",{href:"/.github/workflows/train_deploy.yml"},(0,o.kt)("inlineCode",{parentName:"p"},'"/.github/workflows/train_deploy.yml"')," file")," if you only want to train the model. Uncomment line 7 to 8, if you only want to kick off the workflow when pushing changes to the ",(0,o.kt)("inlineCode",{parentName:"p"},'"/code/"')," file."),(0,o.kt)("h3",{id:"6-viewing-your-aml-resources-and-runs"},"6. Viewing your AML resources and runs"),(0,o.kt)("p",null,"The log outputs of your action will provide URLs for you to view the resources that have been created in AML. Alternatively, you can visit the ",(0,o.kt)("a",{parentName:"p",href:"https://ml.azure.com/"},"Machine Learning Studio")," to view the progress of your runs, etc. For more details, read the documentation below."),(0,o.kt)("h1",{id:"documentation"},"Documentation"),(0,o.kt)("h2",{id:"code-structure"},"Code structure"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"File/folder"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},".cloud/.azure/workspace.json")),(0,o.kt)("td",{parentName:"tr",align:null},"file containing the workspace information to use for machine learning.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},".cloud/.azure/aml_compute.json")),(0,o.kt)("td",{parentName:"tr",align:null},"file containing the aml compute information to use for machine learning.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},".cloud/.azure/aks_compute.json")),(0,o.kt)("td",{parentName:"tr",align:null},"file containing the aml compute information to use for machine learning.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},".cloud/.azure/run.json")),(0,o.kt)("td",{parentName:"tr",align:null},"file containing the training run information to use for machine learning.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},".cloud/.azure/registermodel.json")),(0,o.kt)("td",{parentName:"tr",align:null},"file containing the registring information to register a model to azure machine learning.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},".cloud/.azure/aci_deploy.json")),(0,o.kt)("td",{parentName:"tr",align:null},"file containing the deployment configuration to deploy a model to ACI on azure machine learning.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},".cloud/.azure/aks_deploy.json")),(0,o.kt)("td",{parentName:"tr",align:null},"file containing the deployment configuration to deploy a model to AKS on azure machine learning.")))),(0,o.kt)("h2",{id:"documentation-of-azure-machine-learning-github-actions"},"Documentation of Azure Machine Learning GitHub Actions"),(0,o.kt)("p",null,"The template uses the open source Azure certified Actions listed below. Click on the links and read the README files for more details."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/Azure/aml-workspace"},"aml-workspace")," - Connects to or creates a new workspace"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/Azure/aml-compute"},"aml-compute")," - Connects to or creates a new compute target in Azure Machine Learning"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/Azure/aml-run"},"aml-run")," - Submits a ScriptRun, an Estimator or a Pipeline to Azure Machine Learning"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/Azure/aml-registermodel"},"aml-registermodel")," - Registers a model to Azure Machine Learning"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/Azure/aml-deploy"},"aml-deploy")," - Deploys a model and creates an endpoint for the model")),(0,o.kt)("h2",{id:"known-issues"},"Known issues"),(0,o.kt)("h3",{id:"error-missingsubscriptionregistration"},"Error: MissingSubscriptionRegistration"),(0,o.kt)("p",null,"Error message: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"Message: ***'error': ***'code': 'MissingSubscriptionRegistration', 'message': \"The subscription is not registered to use namespace 'Microsoft.KeyVault'. See https://aka.ms/rps-not-found for how to register subscriptions.\", 'details': [***'code': 'MissingSubscriptionRegistration', 'target': 'Microsoft.KeyVault', 'message': \"The subscription is not registered to use namespace 'Microsoft.KeyVault'. See https://aka.ms/rps-not-found for how to register subscriptions\n")),(0,o.kt)("p",null,"Solution:"),(0,o.kt)("p",null,"This error message appears, in case the ",(0,o.kt)("inlineCode",{parentName:"p"},"Azure/aml-workspace")," action tries to create a new Azure Machine Learning workspace in your resource group and you have never deployed a Key Vault in the subscription before. We recommend to create an Azure Machine Learning workspace manually in the Azure Portal. Follow the ",(0,o.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/machine-learning/tutorial-1st-experiment-sdk-setup#create-a-workspace"},"steps on this website")," to create a new workspace with the desired name. After ou have successfully completed the steps, you have to make sure, that your Service Principal has access to the resource group and that the details in your ",(0,o.kt)("a",{href:"/.cloud/.azure/workspace.json"},(0,o.kt)("inlineCode",{parentName:"p"},'/.cloud/.azure/workspace.json"')," file")," are correct and point to the right workspace and resource group."),(0,o.kt)("h1",{id:"what-is-mlops"},"What is MLOps?"),(0,o.kt)("p",{align:"center"},(0,o.kt)("img",{src:"docs/images/ml-lifecycle.png",alt:"Azure Machine Learning Lifecycle",width:"700"})),(0,o.kt)("p",null,"MLOps empowers data scientists and machine learning engineers to bring together their knowledge and skills to simplify the process of going from model development to release/deployment. ML Ops enables you to track, version, test, certify and reuse assets in every part of the machine learning lifecycle and provides orchestration services to streamline managing this lifecycle. This allows practitioners to automate the end to end machine Learning lifecycle to frequently update models, test new models, and continuously roll out new ML models alongside your other applications and services."),(0,o.kt)("p",null,"This repository enables Data Scientists to focus on the training and deployment code of their machine learning project (",(0,o.kt)("inlineCode",{parentName:"p"},"code")," folder of this repository). Once new code is checked into the ",(0,o.kt)("inlineCode",{parentName:"p"},"code")," folder of the master branch of this repository the GitHub workflow is triggered and open source Azure Machine Learning actions are used to automatically manage the training through to deployment phases."),(0,o.kt)("h1",{id:"contributing"},"Contributing"),(0,o.kt)("p",null,"This project welcomes contributions and suggestions.  Most contributions require you to agree to a\nContributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us\nthe rights to use your contribution. For details, visit ",(0,o.kt)("a",{parentName:"p",href:"https://cla.opensource.microsoft.com"},"https://cla.opensource.microsoft.com"),"."),(0,o.kt)("p",null,"When you submit a pull request, a CLA bot will automatically determine whether you need to provide\na CLA and decorate the PR appropriately (e.g., status check, comment). Simply follow the instructions\nprovided by the bot. You will only need to do this once across all repos using our CLA."),(0,o.kt)("p",null,"This project has adopted the ",(0,o.kt)("a",{parentName:"p",href:"https://opensource.microsoft.com/codeofconduct/"},"Microsoft Open Source Code of Conduct"),".\nFor more information see the ",(0,o.kt)("a",{parentName:"p",href:"https://opensource.microsoft.com/codeofconduct/faq/"},"Code of Conduct FAQ")," or\ncontact ",(0,o.kt)("a",{parentName:"p",href:"mailto:opencode@microsoft.com"},"opencode@microsoft.com")," with any additional questions or comments."))}p.isMDXComponent=!0}}]);